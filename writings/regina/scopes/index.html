<!DOCTYPE html>
<html date="2022-11-05" data-theme="dark">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>WATERSTOPPER | Scopes</title>
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/colors.css">
    <link rel="stylesheet" href="/css/writing.css">

    <link rel="icon" type="image/svg+xml" href="/resources/avatar.svg">
    <script type="text/javascript">
        function preLoadFunc() {
let theme = localStorage.getItem("theme") ?? "light";
            document.documentElement.setAttribute("data-theme", theme);
        }
        window.onload = preLoadFunc;
    </script>
    
</head>

<body>
    <h1 style="text-align: center;">Scopes</h1>
<p>All scopes, sorted from the most visible to the least:</p>
<h2 id="global-scope">Global scope</h2>
<p>Classes, objects and functions<a href="#fn1" class="footnote-ref"
id="fnref1" role="doc-noteref"><sup>1</sup></a> are declared in global
scope. Imported file declarations are in global scope too. Global scope
declarations are visible <strong>everywhere</strong>.</p>
<h2 id="class-instance-scope">Class instance scope</h2>
<p>In class instance scope properties and functions are declared. These
declarations are visible <strong>from a class instance and inside class
functions</strong>.</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">/** this program prints:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">changed</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">in class</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">in global</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">**/</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> A<span class="op">(</span>prop<span class="op">=</span><span class="st">&quot;changed&quot;</span><span class="op">)</span>    </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    print<span class="op">(</span>a<span class="op">.</span>logger<span class="op">())</span> <span class="co">// function called from an instance</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> A <span class="op">{</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">// here prop, this.func and logger are visible</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    prop <span class="op">=</span> <span class="st">&quot;prop&quot;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">func</span><span class="op">()</span> <span class="op">{</span> <span class="kw">return</span> <span class="st">&quot;in class&quot;</span> <span class="op">}</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">logger</span><span class="op">(</span><span class="va">param</span> <span class="op">=</span> prop<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        print<span class="op">(</span>param<span class="op">)</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        print<span class="op">(</span><span class="kw">this</span><span class="op">.</span>func<span class="op">())</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> func<span class="op">()</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">func</span><span class="op">()</span> <span class="op">{</span> <span class="kw">return</span> <span class="st">&quot;in global&quot;</span><span class="op">}</span></span></code></pre></div>
<h2 id="function-scope">Function scope</h2>
<p>Functions can have variable assignments and blocks. Functions change
its reference arguments. All global scope declarations: other global
functions, class constructors, object variables are visible inside a
function body.</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">object</span> Colors <span class="op">{</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    BLACK <span class="op">=</span> <span class="st">&quot;000000&quot;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> A <span class="op">{}</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">change</span><span class="op">(</span><span class="va">argArr</span><span class="op">,</span> <span class="va">argInstance</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    arg<span class="op">.</span>add<span class="op">(</span><span class="dv">2</span><span class="op">)</span> <span class="co">// assuming arg is a list</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    Colors<span class="op">.</span>BLACK <span class="op">=</span> <span class="st">&quot;111111&quot;</span> <span class="co">// Colors.BLACK is changed</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    argInstance<span class="op">.</span>property <span class="op">=</span> <span class="dv">3</span> <span class="co">// property will change outside of function scope</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    arr <span class="op">=</span> <span class="op">[]</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> A<span class="op">()</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    change<span class="op">(</span>arr<span class="op">,</span>a <span class="op">)</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">// here arr == [2],</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">// a.property == 3</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Variables are visible from anywhere below the variable
declaration.</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">scope</span><span class="op">()</span> <span class="op">{</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>i <span class="op">&lt;</span> <span class="dv">5</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> a <span class="co">// here a is visible and equals 1</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><em>This behaviour differs from most of the languages, consequently
it might change in future.</em></p>
<h2 id="block-scope">Block scope</h2>
<p>Blocks change already defined values. Variables defined inside of
blocks are visible outside to the end of the function scope.</p>
<p>Block scope is nonexistent in some sense.</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">someFunction</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// a == 5</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>condition<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        b <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// a == 3</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// a == 3</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// b == 2</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="accessing-declarations-with-same-names">Accessing declarations
with same names</h2>
<p>Each file might contain only one function with a particular
signature. Same holds for classes and objects. However, it is okay to
have class and function with the same name (and no function params) - in
this case class will be shadowed by that function.</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> same <span class="op">{}</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">same</span><span class="op">()</span> <span class="op">{</span><span class="kw">return</span> <span class="dv">1</span><span class="op">}</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> difSignature <span class="op">{}</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">difSignature</span><span class="op">(</span><span class="va">param</span><span class="op">)</span> <span class="op">{}</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    print<span class="op">(</span>same<span class="op">())</span> <span class="co">// 1</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    print<span class="op">(</span>difSignature<span class="op">())</span> <span class="co">// class instance</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 id="import-priority">Import priority</h3>
<p>If imported file contains a declaration with the same name as
existing,</p>
<div class="sourceCode" id="cb6" title="std.geometry2D.rgn"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Point <span class="op">{</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span></code></pre></div>
<p>Current file’s declaration is prioritized.</p>
<div class="sourceCode" id="cb7" title="main.rgn"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">std</span><span class="op">.</span><span class="im">geometry2D</span> <span class="kw">as</span> <span class="dt">geom</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Point <span class="op">{}</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> Point<span class="op">()</span> <span class="co">// main.Point instance</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    pGeom <span class="op">=</span> geom<span class="op">.</span>Point<span class="op">()</span> <span class="co">// std.geometry2D.Point instance</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<blockquote>
<p>[!warning]- Same in different imports</p>
<p>If two imports contain two similarly named declarations (say, both of
them have <code>object Constants</code>) and current file does not have
such declaration, using that declaration without file prefix is
prohibited. That’s because it is ambiguous which declaration to use.</p>
</blockquote>
<h3 id="using-functions-with-same-signature">Using functions with same
signature</h3>
<p>Function signature consists of:</p>
<ol type="1">
<li>function name</li>
<li>number of parameters</li>
</ol>
<p>Priority:</p>
<ol type="1">
<li><p>Local function <strong>always</strong> has priority over imported
one (second step is not applicable, if there is a local function that
can be called).</p></li>
<li><p>Top level function is prioritized over a class function<a
href="#fn2" class="footnote-ref" id="fnref2"
role="doc-noteref"><sup>2</sup></a>.</p></li>
<li><p>Then, find a function with the least number of unspecified
default parameters<a href="#fn3" class="footnote-ref" id="fnref3"
role="doc-noteref"><sup>3</sup></a> (those which are not arguments in a
call). For instance, if there are functions:</p>
<ol type="1">
<li><code>fun fn(a1, a2) {...}</code>,</li>
<li><code>fun fn(a1, a2, a3 = 1) {...}</code>,</li>
</ol>
<p>and the call is <code>fn(1,1)</code>, first function is
called.</p></li>
</ol>
<p>Keep in mind, that inherited functions are simply added to the
current subclass. If current class defines the same function, superclass
function is shadowed. Following example might clear things:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>   s <span class="op">=</span> Subclass<span class="op">()</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>   print<span class="op">(</span>s<span class="op">.</span>fn<span class="op">())</span> <span class="co">// &quot;base&quot;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>   log<span class="op">(</span>s<span class="op">.</span>shadow<span class="op">())</span> <span class="co">// &quot;this is called&quot;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Superclass <span class="op">{</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>   <span class="kw">fun</span> <span class="fu">fn</span><span class="op">()</span> <span class="op">{</span><span class="kw">return</span> <span class="st">&quot;base&quot;</span><span class="op">}</span> </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>   <span class="kw">fun</span> <span class="fu">shadow</span><span class="op">()</span> <span class="op">{</span><span class="kw">return</span> <span class="st">&quot;not called&quot;</span><span class="op">}</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Subclass<span class="op">:</span> <span class="dt">Superclass</span> <span class="op">{</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>   <span class="kw">fun</span> <span class="fu">fn</span><span class="op">(</span><span class="va">a</span> <span class="op">=</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span><span class="st">&quot;not called, because fn without default parameters has more priority&quot;</span><span class="op">}</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>   <span class="kw">fun</span> <span class="fu">shadow</span><span class="op">()</span> <span class="op">{</span><span class="kw">return</span> <span class="st">&quot;this is called&quot;</span><span class="op">}</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>Functions can be declared in classes too.<a
href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>This is due to the fact that class instance function can
be called with <code>this.</code> prefix. Current class function does
not have a prefix to be called with.<a href="#fnref2"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Currently if there are two functions in
<strong>different</strong> imports that both can be called, program will
throw an error saying that it cannot pick needed function.<a
href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

    <p style="text-align: center; font-size: large;"><a href="/">Main</a> | <a href="/writings">Writings</a> | <a href="/drawings">Drawings</a></p>
    <div style="text-align: center;">꧁༻ ༺꧂</div>
</body>
</html>